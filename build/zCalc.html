<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>zCalc</title>
  <style>body,html{padding:0;margin:0}.zcalc_,.zcalc_ ._input{border:1px solid #d0d0d0;color:#333}html{font-family:tahoma,arial,verdana,sans-serif,"Lucida Sans";font-size:10px}body{font-size:1.6em;background-color:#eee}.container{margin:5px auto;position:relative;width:645px}div{box-sizing:border-box}.left-block{width:20pc;margin-right:325px}.right-block{float:right;font-size:.7em;height:500px;overflow-x:hidden;overflow-y:auto;width:20pc}.zcalc_{background-color:#fff;position:relative;width:100%}.zcalc_ ._z-body{padding:15px 15px 0}.zcalc_ ._z-panel{margin:10px 0}.zcalc_ ._z-panel.-bottom{position:absolute;left:10px;right:10px;bottom:0}.zcalc_ ._z-panel.-mid{line-height:2em}.zcalc_ ._input{margin:0;padding:5px 2%;text-align:right;-webkit-transition:border .2s ease-out;transition:border .2s ease-out;width:96%}.zcalc_ ._btn,.zcalc_ ._result{padding:10px 0;font-weight:700}.zcalc_ ._input:focus{border:1px solid #a0a0a0;outline:0}.zcalc_ ._btn{background-color:#3a9bdc;border:1px solid #2980b9;border-radius:4px;width:100%}.zcalc_ ._btn:active{background-color:#2980b9}.zcalc_ ._btn:focus{outline:0}.zcalc_ ._result{overflow-x:auto;font-size:2em;text-align:right;white-space:nowrap;width:100%}.zcalc_ ._small{font-size:.7em;margin-left:10px}.zcalc_ ._big{display:inline-block;margin-left:10px}.zcalc_ ._error{color:#f06354}.zcalc_ ._settings{display:none;position:absolute;padding:0 10px;top:50px;left:0;right:0;bottom:0;background-color:#34495e}.zcalc_ ._settings select{color:#333}.zcalc_ ._settings.-shown{display:block}.zcalc_ ._z-bottom{padding:5px 15px;text-align:center;font-size:.7em}.log,.right-block .log{border:1px solid #d0d0d0;padding:5px;background-color:#fff}.zcalc_ ._z-bottom span{display:inline-block;font-size:1em;font-weight:700;padding-right:5px}.zcalc_ ._z-bottom a{color:#3a9bdc}.zcalc_ ._z-bottom a:hover{color:#2980b9}.zcalc_ ._z-bottom a:visited{color:#3a9bdc}.log-container{margin:5px auto;font-size:.7em;overflow-x:hidden;position:relative;width:100%}.log{width:100%;-webkit-transition:margin 150ms ease-in;transition:margin 150ms ease-in}.log div{margin-bottom:3px;word-break:break-all}.right-block .log{margin-bottom:5px;margin-left:100%;position:relative}.right-block .log .remove-log{background-color:#fff;color:#888;cursor:pointer;display:none;padding:2px 5px;position:absolute;right:0;top:0}.right-block .log:hover .remove-log{display:block}.right-block .log:hover .remove-log:hover{color:#333}</style>
</head>
<body>
<div class="container">
  <div id="saved-logs" class="right-block">
  </div>
  <div class="left-block">
    <div class="zcalc_">
      <div class="_z-center">
        <div class="_z-body">
          <div class="_z-panel">
            <input type="text" id="user-input" class="_input"/>
          </div>
          <div class="_z-panel">
            <div id="result" class="_result">0</div>
          </div>
        </div>
      </div>
      <div class="_z-bottom"><span>zCalc</span><a href="https://github.com/deLiero/zCalc">deLiero</a></div>
    </div>
    <div id="log-container" class="log-container">
    </div>
  </div>
</div>
  <script>function ZCalc(){function n(n){return n.replace(/[^1-9]/g,"")}this.calculate=function(e){if(e=n(e),0==(e+"").length)return[0];var t=0,l=[];for(l.push(e);e>9;){e+="";for(var a=0;a<e.length;a++)t+=parseInt(e.charAt(a));e=t,l.push(e),t=0}return l}}window.onload=function(){function n(n,a){try{var r=d.calculate(a),i=l(r);v=e(n,o.value,i)}catch(u){console.error(u.message),t(u)}finally{o.focus()}}function e(n,e,t){for(var l="",a=0;a<t.length;a++)0==a?l+=t[a]:l=l+" "+t[a];return s.innerHTML="<div class='log'><div><b>input: </b>"+n+"</div><div><b>normalized: </b>"+e+"</div><div><b>output: </b>"+l+"</div></div>",{before:n,after:e,result:t}}function t(n){s.innerHTML="<div class='log'><div><b>error: </b>"+n.message+"</div></div>"}function l(n){if("undefined"!=typeof n&&0!=n.length){var e=n.length;return 1==e?(u.innerHTML=n[0],[n[0]]):2==e?(u.innerHTML=n[e-1],[n[e-1]]):3==e?(u.innerHTML='<span class="_small">'+n[e-2]+'</span><span class="_big">'+n[e-1]+"</span>",[n[e-2],n[e-1]]):(u.innerHTML='<span class="_small">'+n[e-3]+'</span><span class="_small">'+n[e-2]+'</span><span class="_big">'+n[e-1]+"</span>",[n[e-3],n[e-2],n[e-1]])}}function a(n){n&&c.removeChild(n)}function r(n){return n?(c.insertBefore(n,c.firstChild),!0):!1}function i(n){if(!n)return null;for(var e="",t=0;t<n.result.length;t++)0==t?e+=n.result[t]:e=e+" "+n.result[t];var l="<div class='remove-log'>удалить</div><div><b>input: </b>"+n.before+"</div><div><b>normalized: </b>"+n.after+"</div><div><b>output: </b>"+e+"</div>",a=document.createElement("div");return a.className="log",a.innerHTML=l,a}var o=document.getElementById("user-input"),u=document.getElementById("result"),s=document.getElementById("log-container"),c=document.getElementById("saved-logs"),v=null,d=new ZCalc,f=13;window.onblur=function(){o.blur()},window.onfocus=function(){o.select()},o.oninput=function(){var e=o.value;o.value=o.value.replace(/[^1-9]/g,""),n(e,o.value)},o.onkeydown=function(e){if(e.which==f){e.preventDefault();var t=o.value;o.value=o.value.replace(/[^1-9]/g,""),n(t,o.value)}},document.body.onkeydown=function(n){if(39===n.which){var e=i(v);if(null!==e){v=null;var t=s.getElementsByClassName("log")[0];t.style.marginLeft="-100%",r(e),setTimeout(function(){e.style.marginLeft="0"},100)}}},c.onclick=function(n){var e=n.target;if("remove-log"===e.className){var t=e.parentNode;"log"===t.className&&a(t)}},o.focus()};</script>
</body>
</html>